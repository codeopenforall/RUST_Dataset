    if input.len() > buf.len() {
        return Err("Input too large");
    }
