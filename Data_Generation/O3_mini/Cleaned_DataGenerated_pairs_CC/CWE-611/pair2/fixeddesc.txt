In the corrected version, external entity resolution is proactively disabled by setting the flag to false in the constructor. As a result, even if the XML contains external entity declarations, the parser does not attempt to resolve them through the unsafe resolution path. This prevents inadvertent disclosure of sensitive information found in external files, effectively mitigating CWE-611. The overall design remains similar, ensuring that no other functionality is disrupted.