This version demonstrates an XML processing routine vulnerable to CWE-611 (Improper Restriction of XML External Entities). It insidiously resolves external entities from the XML input. The vulnerability is introduced by spawning a thread that executes an unsafe block to perform unchecked pointer manipulation and external file access. This design can be exploited to read unintended files, thus exposing sensitive data.